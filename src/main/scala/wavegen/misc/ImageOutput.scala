package wavegen.misc

import chisel3._
import chisel3.util._

class ImageOutput extends Module {
	val imageWidth  = 160
	val imageHeight = 144

	val io = IO(new Bundle {
		val x       = Input(UInt(11.W))
		val y       = Input(UInt(10.W))
		val sw      = Input(UInt(8.W))
		val rom     = Input(UInt(4.W))
		val pulseL = Input(Bool())
		val pulseR = Input(Bool())
		val addr    = Output(UInt(15.W))
		val red     = Output(UInt(8.W))
		val green   = Output(UInt(8.W))
		val blue    = Output(UInt(8.W))
	})

	val slideshow = Module(new wavegen.presentation.Slideshow)
	val slide = RegInit(0.U(8.W))

	slideshow.io.slide := 0.U
	slideshow.io.x := io.x
	slideshow.io.y := io.y

	val leftOn  = RegInit(false.B)
	val rightOn = RegInit(false.B)

	val maxSlides = 16

	when (io.pulseL) {
		slide := Mux(slide === 0.U, maxSlides.U, slide - 1.U)
	}

	when (io.pulseR) {
		slide := Mux(slide < maxSlides.U, slide + 1.U, 0.U)
	}

	io.addr := 0.U

	when (slide === 0.U) {
		val hueClocker = Module(new wavegen.StaticClocker(50, 74_250_000, "HueClocker"))
		hueClocker.io.enable := true.B

		// Hehe :)
		val table = VecInit(180.U(10.W), 180.U(10.W), 181.U(10.W), 182.U(10.W), 183.U(10.W), 184.U(10.W), 185.U(10.W), 186.U(10.W), 187.U(10.W), 187.U(10.W), 188.U(10.W), 189.U(10.W), 190.U(10.W), 191.U(10.W), 192.U(10.W), 193.U(10.W), 194.U(10.W), 195.U(10.W), 195.U(10.W), 196.U(10.W), 197.U(10.W), 198.U(10.W), 199.U(10.W), 200.U(10.W), 201.U(10.W), 202.U(10.W), 202.U(10.W), 203.U(10.W), 204.U(10.W), 205.U(10.W), 206.U(10.W), 207.U(10.W), 208.U(10.W), 209.U(10.W), 209.U(10.W), 210.U(10.W), 211.U(10.W), 212.U(10.W), 213.U(10.W), 214.U(10.W), 215.U(10.W), 215.U(10.W), 216.U(10.W), 217.U(10.W), 218.U(10.W), 219.U(10.W), 220.U(10.W), 221.U(10.W), 222.U(10.W), 222.U(10.W), 223.U(10.W), 224.U(10.W), 225.U(10.W), 226.U(10.W), 227.U(10.W), 228.U(10.W), 228.U(10.W), 229.U(10.W), 230.U(10.W), 231.U(10.W), 232.U(10.W), 233.U(10.W), 233.U(10.W), 234.U(10.W), 235.U(10.W), 236.U(10.W), 237.U(10.W), 238.U(10.W), 238.U(10.W), 239.U(10.W), 240.U(10.W), 241.U(10.W), 242.U(10.W), 243.U(10.W), 243.U(10.W), 244.U(10.W), 245.U(10.W), 246.U(10.W), 247.U(10.W), 248.U(10.W), 248.U(10.W), 249.U(10.W), 250.U(10.W), 251.U(10.W), 252.U(10.W), 252.U(10.W), 253.U(10.W), 254.U(10.W), 255.U(10.W), 256.U(10.W), 256.U(10.W), 257.U(10.W), 258.U(10.W), 259.U(10.W), 260.U(10.W), 260.U(10.W), 261.U(10.W), 262.U(10.W), 263.U(10.W), 264.U(10.W), 264.U(10.W), 265.U(10.W), 266.U(10.W), 267.U(10.W), 267.U(10.W), 268.U(10.W), 269.U(10.W), 270.U(10.W), 271.U(10.W), 271.U(10.W), 272.U(10.W), 273.U(10.W), 274.U(10.W), 274.U(10.W), 275.U(10.W), 276.U(10.W), 277.U(10.W), 277.U(10.W), 278.U(10.W), 279.U(10.W), 280.U(10.W), 280.U(10.W), 281.U(10.W), 282.U(10.W), 282.U(10.W), 283.U(10.W), 284.U(10.W), 285.U(10.W), 285.U(10.W), 286.U(10.W), 287.U(10.W), 287.U(10.W), 288.U(10.W), 289.U(10.W), 290.U(10.W), 290.U(10.W), 291.U(10.W), 292.U(10.W), 292.U(10.W), 293.U(10.W), 294.U(10.W), 294.U(10.W), 295.U(10.W), 296.U(10.W), 296.U(10.W), 297.U(10.W), 298.U(10.W), 298.U(10.W), 299.U(10.W), 300.U(10.W), 300.U(10.W), 301.U(10.W), 302.U(10.W), 302.U(10.W), 303.U(10.W), 304.U(10.W), 304.U(10.W), 305.U(10.W), 306.U(10.W), 306.U(10.W), 307.U(10.W), 307.U(10.W), 308.U(10.W), 309.U(10.W), 309.U(10.W), 310.U(10.W), 310.U(10.W), 311.U(10.W), 312.U(10.W), 312.U(10.W), 313.U(10.W), 313.U(10.W), 314.U(10.W), 315.U(10.W), 315.U(10.W), 316.U(10.W), 316.U(10.W), 317.U(10.W), 318.U(10.W), 318.U(10.W), 319.U(10.W), 319.U(10.W), 320.U(10.W), 320.U(10.W), 321.U(10.W), 321.U(10.W), 322.U(10.W), 322.U(10.W), 323.U(10.W), 324.U(10.W), 324.U(10.W), 325.U(10.W), 325.U(10.W), 326.U(10.W), 326.U(10.W), 327.U(10.W), 327.U(10.W), 328.U(10.W), 328.U(10.W), 329.U(10.W), 329.U(10.W), 330.U(10.W), 330.U(10.W), 331.U(10.W), 331.U(10.W), 332.U(10.W), 332.U(10.W), 333.U(10.W), 333.U(10.W), 333.U(10.W), 334.U(10.W), 334.U(10.W), 335.U(10.W), 335.U(10.W), 336.U(10.W), 336.U(10.W), 337.U(10.W), 337.U(10.W), 337.U(10.W), 338.U(10.W), 338.U(10.W), 339.U(10.W), 339.U(10.W), 339.U(10.W), 340.U(10.W), 340.U(10.W), 341.U(10.W), 341.U(10.W), 341.U(10.W), 342.U(10.W), 342.U(10.W), 343.U(10.W), 343.U(10.W), 343.U(10.W), 344.U(10.W), 344.U(10.W), 344.U(10.W), 345.U(10.W), 345.U(10.W), 345.U(10.W), 346.U(10.W), 346.U(10.W), 346.U(10.W), 347.U(10.W), 347.U(10.W), 347.U(10.W), 348.U(10.W), 348.U(10.W), 348.U(10.W), 349.U(10.W), 349.U(10.W), 349.U(10.W), 350.U(10.W), 350.U(10.W), 350.U(10.W), 350.U(10.W), 351.U(10.W), 351.U(10.W), 351.U(10.W), 351.U(10.W), 352.U(10.W), 352.U(10.W), 352.U(10.W), 353.U(10.W), 353.U(10.W), 353.U(10.W), 353.U(10.W), 353.U(10.W), 354.U(10.W), 354.U(10.W), 354.U(10.W), 354.U(10.W), 355.U(10.W), 355.U(10.W), 355.U(10.W), 355.U(10.W), 355.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 360.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 359.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 358.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 357.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 356.U(10.W), 355.U(10.W), 355.U(10.W), 355.U(10.W), 355.U(10.W), 355.U(10.W), 354.U(10.W), 354.U(10.W), 354.U(10.W), 354.U(10.W), 353.U(10.W), 353.U(10.W), 353.U(10.W), 353.U(10.W), 353.U(10.W), 352.U(10.W), 352.U(10.W), 352.U(10.W), 351.U(10.W), 351.U(10.W), 351.U(10.W), 351.U(10.W), 350.U(10.W), 350.U(10.W), 350.U(10.W), 350.U(10.W), 349.U(10.W), 349.U(10.W), 349.U(10.W), 348.U(10.W), 348.U(10.W), 348.U(10.W), 347.U(10.W), 347.U(10.W), 347.U(10.W), 346.U(10.W), 346.U(10.W), 346.U(10.W), 345.U(10.W), 345.U(10.W), 345.U(10.W), 344.U(10.W), 344.U(10.W), 344.U(10.W), 343.U(10.W), 343.U(10.W), 343.U(10.W), 342.U(10.W), 342.U(10.W), 341.U(10.W), 341.U(10.W), 341.U(10.W), 340.U(10.W), 340.U(10.W), 339.U(10.W), 339.U(10.W), 339.U(10.W), 338.U(10.W), 338.U(10.W), 337.U(10.W), 337.U(10.W), 337.U(10.W), 336.U(10.W), 336.U(10.W), 335.U(10.W), 335.U(10.W), 334.U(10.W), 334.U(10.W), 333.U(10.W), 333.U(10.W), 333.U(10.W), 332.U(10.W), 332.U(10.W), 331.U(10.W), 331.U(10.W), 330.U(10.W), 330.U(10.W), 329.U(10.W), 329.U(10.W), 328.U(10.W), 328.U(10.W), 327.U(10.W), 327.U(10.W), 326.U(10.W), 326.U(10.W), 325.U(10.W), 325.U(10.W), 324.U(10.W), 324.U(10.W), 323.U(10.W), 322.U(10.W), 322.U(10.W), 321.U(10.W), 321.U(10.W), 320.U(10.W), 320.U(10.W), 319.U(10.W), 319.U(10.W), 318.U(10.W), 318.U(10.W), 317.U(10.W), 316.U(10.W), 316.U(10.W), 315.U(10.W), 315.U(10.W), 314.U(10.W), 313.U(10.W), 313.U(10.W), 312.U(10.W), 312.U(10.W), 311.U(10.W), 310.U(10.W), 310.U(10.W), 309.U(10.W), 309.U(10.W), 308.U(10.W), 307.U(10.W), 307.U(10.W), 306.U(10.W), 306.U(10.W), 305.U(10.W), 304.U(10.W), 304.U(10.W), 303.U(10.W), 302.U(10.W), 302.U(10.W), 301.U(10.W), 300.U(10.W), 300.U(10.W), 299.U(10.W), 298.U(10.W), 298.U(10.W), 297.U(10.W), 296.U(10.W), 296.U(10.W), 295.U(10.W), 294.U(10.W), 294.U(10.W), 293.U(10.W), 292.U(10.W), 292.U(10.W), 291.U(10.W), 290.U(10.W), 290.U(10.W), 289.U(10.W), 288.U(10.W), 287.U(10.W), 287.U(10.W), 286.U(10.W), 285.U(10.W), 285.U(10.W), 284.U(10.W), 283.U(10.W), 282.U(10.W), 282.U(10.W), 281.U(10.W), 280.U(10.W), 280.U(10.W), 279.U(10.W), 278.U(10.W), 277.U(10.W), 277.U(10.W), 276.U(10.W), 275.U(10.W), 274.U(10.W), 274.U(10.W), 273.U(10.W), 272.U(10.W), 271.U(10.W), 271.U(10.W), 270.U(10.W), 269.U(10.W), 268.U(10.W), 267.U(10.W), 267.U(10.W), 266.U(10.W), 265.U(10.W), 264.U(10.W), 264.U(10.W), 263.U(10.W), 262.U(10.W), 261.U(10.W), 260.U(10.W), 260.U(10.W), 259.U(10.W), 258.U(10.W), 257.U(10.W), 256.U(10.W), 256.U(10.W), 255.U(10.W), 254.U(10.W), 253.U(10.W), 252.U(10.W), 252.U(10.W), 251.U(10.W), 250.U(10.W), 249.U(10.W), 248.U(10.W), 248.U(10.W), 247.U(10.W), 246.U(10.W), 245.U(10.W), 244.U(10.W), 243.U(10.W), 243.U(10.W), 242.U(10.W), 241.U(10.W), 240.U(10.W), 239.U(10.W), 238.U(10.W), 238.U(10.W), 237.U(10.W), 236.U(10.W), 235.U(10.W), 234.U(10.W), 233.U(10.W), 233.U(10.W), 232.U(10.W), 231.U(10.W), 230.U(10.W), 229.U(10.W), 228.U(10.W), 228.U(10.W), 227.U(10.W), 226.U(10.W), 225.U(10.W), 224.U(10.W), 223.U(10.W), 222.U(10.W), 222.U(10.W), 221.U(10.W), 220.U(10.W), 219.U(10.W), 218.U(10.W), 217.U(10.W), 216.U(10.W), 215.U(10.W), 215.U(10.W), 214.U(10.W), 213.U(10.W), 212.U(10.W), 211.U(10.W), 210.U(10.W), 209.U(10.W), 209.U(10.W), 208.U(10.W), 207.U(10.W), 206.U(10.W), 205.U(10.W), 204.U(10.W), 203.U(10.W), 202.U(10.W), 202.U(10.W), 201.U(10.W), 200.U(10.W), 199.U(10.W), 198.U(10.W), 197.U(10.W), 196.U(10.W), 195.U(10.W), 195.U(10.W), 194.U(10.W), 193.U(10.W), 192.U(10.W), 191.U(10.W), 190.U(10.W), 189.U(10.W), 188.U(10.W), 187.U(10.W), 187.U(10.W), 186.U(10.W), 185.U(10.W), 184.U(10.W), 183.U(10.W), 182.U(10.W), 181.U(10.W), 180.U(10.W), 180.U(10.W), 179.U(10.W), 178.U(10.W), 177.U(10.W), 176.U(10.W), 175.U(10.W), 174.U(10.W), 173.U(10.W), 172.U(10.W), 172.U(10.W), 171.U(10.W), 170.U(10.W), 169.U(10.W), 168.U(10.W), 167.U(10.W), 166.U(10.W), 165.U(10.W), 164.U(10.W), 164.U(10.W), 163.U(10.W), 162.U(10.W), 161.U(10.W), 160.U(10.W), 159.U(10.W), 158.U(10.W), 157.U(10.W), 157.U(10.W), 156.U(10.W), 155.U(10.W), 154.U(10.W), 153.U(10.W), 152.U(10.W), 151.U(10.W), 150.U(10.W), 150.U(10.W), 149.U(10.W), 148.U(10.W), 147.U(10.W), 146.U(10.W), 145.U(10.W), 144.U(10.W), 144.U(10.W), 143.U(10.W), 142.U(10.W), 141.U(10.W), 140.U(10.W), 139.U(10.W), 138.U(10.W), 137.U(10.W), 137.U(10.W), 136.U(10.W), 135.U(10.W), 134.U(10.W), 133.U(10.W), 132.U(10.W), 131.U(10.W), 131.U(10.W), 130.U(10.W), 129.U(10.W), 128.U(10.W), 127.U(10.W), 126.U(10.W), 126.U(10.W), 125.U(10.W), 124.U(10.W), 123.U(10.W), 122.U(10.W), 121.U(10.W), 121.U(10.W), 120.U(10.W), 119.U(10.W), 118.U(10.W), 117.U(10.W), 116.U(10.W), 116.U(10.W), 115.U(10.W), 114.U(10.W), 113.U(10.W), 112.U(10.W), 111.U(10.W), 111.U(10.W), 110.U(10.W), 109.U(10.W), 108.U(10.W), 107.U(10.W), 107.U(10.W), 106.U(10.W), 105.U(10.W), 104.U(10.W), 103.U(10.W), 103.U(10.W), 102.U(10.W), 101.U(10.W), 100.U(10.W), 99.U(10.W), 99.U(10.W), 98.U(10.W), 97.U(10.W), 96.U(10.W), 95.U(10.W), 95.U(10.W), 94.U(10.W), 93.U(10.W), 92.U(10.W), 92.U(10.W), 91.U(10.W), 90.U(10.W), 89.U(10.W), 88.U(10.W), 88.U(10.W), 87.U(10.W), 86.U(10.W), 85.U(10.W), 85.U(10.W), 84.U(10.W), 83.U(10.W), 82.U(10.W), 82.U(10.W), 81.U(10.W), 80.U(10.W), 79.U(10.W), 79.U(10.W), 78.U(10.W), 77.U(10.W), 77.U(10.W), 76.U(10.W), 75.U(10.W), 74.U(10.W), 74.U(10.W), 73.U(10.W), 72.U(10.W), 72.U(10.W), 71.U(10.W), 70.U(10.W), 69.U(10.W), 69.U(10.W), 68.U(10.W), 67.U(10.W), 67.U(10.W), 66.U(10.W), 65.U(10.W), 65.U(10.W), 64.U(10.W), 63.U(10.W), 63.U(10.W), 62.U(10.W), 61.U(10.W), 61.U(10.W), 60.U(10.W), 59.U(10.W), 59.U(10.W), 58.U(10.W), 57.U(10.W), 57.U(10.W), 56.U(10.W), 55.U(10.W), 55.U(10.W), 54.U(10.W), 53.U(10.W), 53.U(10.W), 52.U(10.W), 52.U(10.W), 51.U(10.W), 50.U(10.W), 50.U(10.W), 49.U(10.W), 49.U(10.W), 48.U(10.W), 47.U(10.W), 47.U(10.W), 46.U(10.W), 46.U(10.W), 45.U(10.W), 44.U(10.W), 44.U(10.W), 43.U(10.W), 43.U(10.W), 42.U(10.W), 41.U(10.W), 41.U(10.W), 40.U(10.W), 40.U(10.W), 39.U(10.W), 39.U(10.W), 38.U(10.W), 38.U(10.W), 37.U(10.W), 37.U(10.W), 36.U(10.W), 35.U(10.W), 35.U(10.W), 34.U(10.W), 34.U(10.W), 33.U(10.W), 33.U(10.W), 32.U(10.W), 32.U(10.W), 31.U(10.W), 31.U(10.W), 30.U(10.W), 30.U(10.W), 29.U(10.W), 29.U(10.W), 28.U(10.W), 28.U(10.W), 27.U(10.W), 27.U(10.W), 26.U(10.W), 26.U(10.W), 26.U(10.W), 25.U(10.W), 25.U(10.W), 24.U(10.W), 24.U(10.W), 23.U(10.W), 23.U(10.W), 22.U(10.W), 22.U(10.W), 22.U(10.W), 21.U(10.W), 21.U(10.W), 20.U(10.W), 20.U(10.W), 20.U(10.W), 19.U(10.W), 19.U(10.W), 18.U(10.W), 18.U(10.W), 18.U(10.W), 17.U(10.W), 17.U(10.W), 16.U(10.W), 16.U(10.W), 16.U(10.W), 15.U(10.W), 15.U(10.W), 15.U(10.W), 14.U(10.W), 14.U(10.W), 14.U(10.W), 13.U(10.W), 13.U(10.W), 13.U(10.W), 12.U(10.W), 12.U(10.W), 12.U(10.W), 11.U(10.W), 11.U(10.W), 11.U(10.W), 10.U(10.W), 10.U(10.W), 10.U(10.W), 9.U(10.W), 9.U(10.W), 9.U(10.W), 9.U(10.W), 8.U(10.W), 8.U(10.W), 8.U(10.W), 8.U(10.W), 7.U(10.W), 7.U(10.W), 7.U(10.W), 6.U(10.W), 6.U(10.W), 6.U(10.W), 6.U(10.W), 6.U(10.W), 5.U(10.W), 5.U(10.W), 5.U(10.W), 5.U(10.W), 4.U(10.W), 4.U(10.W), 4.U(10.W), 4.U(10.W), 4.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 0.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 1.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 2.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 3.U(10.W), 4.U(10.W), 4.U(10.W), 4.U(10.W), 4.U(10.W), 4.U(10.W), 5.U(10.W), 5.U(10.W), 5.U(10.W), 5.U(10.W), 6.U(10.W), 6.U(10.W), 6.U(10.W), 6.U(10.W), 6.U(10.W), 7.U(10.W), 7.U(10.W), 7.U(10.W), 8.U(10.W), 8.U(10.W), 8.U(10.W), 8.U(10.W), 9.U(10.W), 9.U(10.W), 9.U(10.W), 9.U(10.W), 10.U(10.W), 10.U(10.W), 10.U(10.W), 11.U(10.W), 11.U(10.W), 11.U(10.W), 12.U(10.W), 12.U(10.W), 12.U(10.W), 13.U(10.W), 13.U(10.W), 13.U(10.W), 14.U(10.W), 14.U(10.W), 14.U(10.W), 15.U(10.W), 15.U(10.W), 15.U(10.W), 16.U(10.W), 16.U(10.W), 16.U(10.W), 17.U(10.W), 17.U(10.W), 18.U(10.W), 18.U(10.W), 18.U(10.W), 19.U(10.W), 19.U(10.W), 20.U(10.W), 20.U(10.W), 20.U(10.W), 21.U(10.W), 21.U(10.W), 22.U(10.W), 22.U(10.W), 22.U(10.W), 23.U(10.W), 23.U(10.W), 24.U(10.W), 24.U(10.W), 25.U(10.W), 25.U(10.W), 26.U(10.W), 26.U(10.W), 26.U(10.W), 27.U(10.W), 27.U(10.W), 28.U(10.W), 28.U(10.W), 29.U(10.W), 29.U(10.W), 30.U(10.W), 30.U(10.W), 31.U(10.W), 31.U(10.W), 32.U(10.W), 32.U(10.W), 33.U(10.W), 33.U(10.W), 34.U(10.W), 34.U(10.W), 35.U(10.W), 35.U(10.W), 36.U(10.W), 37.U(10.W), 37.U(10.W), 38.U(10.W), 38.U(10.W), 39.U(10.W), 39.U(10.W), 40.U(10.W), 40.U(10.W), 41.U(10.W), 41.U(10.W), 42.U(10.W), 43.U(10.W), 43.U(10.W), 44.U(10.W), 44.U(10.W), 45.U(10.W), 46.U(10.W), 46.U(10.W), 47.U(10.W), 47.U(10.W), 48.U(10.W), 49.U(10.W), 49.U(10.W), 50.U(10.W), 50.U(10.W), 51.U(10.W), 52.U(10.W), 52.U(10.W), 53.U(10.W), 53.U(10.W), 54.U(10.W), 55.U(10.W), 55.U(10.W), 56.U(10.W), 57.U(10.W), 57.U(10.W), 58.U(10.W), 59.U(10.W), 59.U(10.W), 60.U(10.W), 61.U(10.W), 61.U(10.W), 62.U(10.W), 63.U(10.W), 63.U(10.W), 64.U(10.W), 65.U(10.W), 65.U(10.W), 66.U(10.W), 67.U(10.W), 67.U(10.W), 68.U(10.W), 69.U(10.W), 69.U(10.W), 70.U(10.W), 71.U(10.W), 72.U(10.W), 72.U(10.W), 73.U(10.W), 74.U(10.W), 74.U(10.W), 75.U(10.W), 76.U(10.W), 77.U(10.W), 77.U(10.W), 78.U(10.W), 79.U(10.W), 79.U(10.W), 80.U(10.W), 81.U(10.W), 82.U(10.W), 82.U(10.W), 83.U(10.W), 84.U(10.W), 85.U(10.W), 85.U(10.W), 86.U(10.W), 87.U(10.W), 88.U(10.W), 88.U(10.W), 89.U(10.W), 90.U(10.W), 91.U(10.W), 92.U(10.W), 92.U(10.W), 93.U(10.W), 94.U(10.W), 95.U(10.W), 95.U(10.W), 96.U(10.W), 97.U(10.W), 98.U(10.W), 99.U(10.W), 99.U(10.W), 100.U(10.W), 101.U(10.W), 102.U(10.W), 103.U(10.W), 103.U(10.W), 104.U(10.W), 105.U(10.W), 106.U(10.W), 107.U(10.W), 107.U(10.W), 108.U(10.W), 109.U(10.W), 110.U(10.W), 111.U(10.W), 111.U(10.W), 112.U(10.W), 113.U(10.W), 114.U(10.W), 115.U(10.W), 116.U(10.W), 116.U(10.W), 117.U(10.W), 118.U(10.W), 119.U(10.W), 120.U(10.W), 121.U(10.W), 121.U(10.W), 122.U(10.W), 123.U(10.W), 124.U(10.W), 125.U(10.W), 126.U(10.W), 126.U(10.W), 127.U(10.W), 128.U(10.W), 129.U(10.W), 130.U(10.W), 131.U(10.W), 131.U(10.W), 132.U(10.W), 133.U(10.W), 134.U(10.W), 135.U(10.W), 136.U(10.W), 137.U(10.W), 137.U(10.W), 138.U(10.W), 139.U(10.W), 140.U(10.W), 141.U(10.W), 142.U(10.W), 143.U(10.W), 144.U(10.W), 144.U(10.W), 145.U(10.W), 146.U(10.W), 147.U(10.W), 148.U(10.W), 149.U(10.W), 150.U(10.W), 150.U(10.W), 151.U(10.W), 152.U(10.W), 153.U(10.W), 154.U(10.W), 155.U(10.W), 156.U(10.W), 157.U(10.W), 157.U(10.W), 158.U(10.W), 159.U(10.W), 160.U(10.W), 161.U(10.W), 162.U(10.W), 163.U(10.W), 164.U(10.W), 164.U(10.W), 165.U(10.W), 166.U(10.W), 167.U(10.W), 168.U(10.W), 169.U(10.W), 170.U(10.W), 171.U(10.W), 172.U(10.W), 172.U(10.W), 173.U(10.W), 174.U(10.W), 175.U(10.W), 176.U(10.W), 177.U(10.W), 178.U(10.W), 179.U(10.W))

		val shift = table(io.x)

		val (hue, hueWrap) = Counter(0 to 255, hueClocker.io.tick)
		val adjustedHue = (hue + (io.x >> 2.U) + (io.y >> 3.U) - shift)(7, 0)

		val colors = Module(new Colors)
		colors.io.hue := adjustedHue
		io.red   := colors.io.red
		io.green := colors.io.green
		io.blue  := colors.io.blue

		val x = Cat(0.U(2.W), io.x >> 2.U).asSInt - 80.S
		val y = Cat(0.U(2.W), io.y >> 2.U).asSInt - 18.S

		val palette = VecInit("h000000".U, "h090725".U, "h09081e".U, "h721f18".U, "hdb0026".U, "hdf0861".U, "h005a0e".U,
		                      "h005d02".U, "h4e4dc3".U, "h4e4ebd".U, "h209d06".U, "h1ca000".U, "hc27551".U, "hefac2e".U,
		                      "hf2ddd7".U, "hf8f8f8".U)

		io.addr := (x + y * imageWidth.S).asUInt

		when (0.S <= x && x < imageWidth.S && 0.S <= y && y < imageHeight.S) {
			val color = palette(io.rom)
			io.red   := color(23, 16)
			io.green := color(15,  8)
			io.blue  := color( 7,  0)
		}
	} .otherwise {
		slideshow.io.slide := slide - 1.U
		io.red   := slideshow.io.red
		io.green := slideshow.io.green
		io.blue  := slideshow.io.blue
	}
}
